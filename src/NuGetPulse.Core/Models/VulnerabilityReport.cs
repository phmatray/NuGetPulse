namespace NuGetPulse.Core.Models;

/// <summary>A vulnerability found via OSV database for a specific package version.</summary>
public sealed class VulnerabilityReport
{
    public string PackageId { get; init; } = string.Empty;
    public string Version { get; init; } = string.Empty;
    public List<OsvVulnerability> Vulnerabilities { get; init; } = [];

    public bool HasVulnerabilities => Vulnerabilities.Count > 0;
    public int Count => Vulnerabilities.Count;
}

/// <summary>A single OSV vulnerability entry.</summary>
public sealed class OsvVulnerability
{
    public string Id { get; init; } = string.Empty;
    public string Summary { get; init; } = string.Empty;
    public string? Details { get; init; }
    public OsvSeverity Severity { get; init; }
    public string? CvssScore { get; init; }
    public List<string> Aliases { get; init; } = [];
    public string? ReferenceUrl { get; init; }
    public DateTime? Published { get; init; }
    public DateTime? Modified { get; init; }
}

public enum OsvSeverity { Unknown, Low, Medium, High, Critical }
