using NuGetPulse.Core.Models;

namespace NuGetPulse.Core.Abstractions;

/// <summary>Scans NuGet packages for known vulnerabilities via the OSV database.</summary>
public interface IVulnerabilityScanner
{
    /// <summary>Scan a single package version for vulnerabilities.</summary>
    Task<VulnerabilityReport> ScanAsync(string packageId, string version, CancellationToken ct = default);

    /// <summary>Scan multiple packages in bulk (batch OSV query).</summary>
    Task<IReadOnlyList<VulnerabilityReport>> ScanBatchAsync(
        IEnumerable<(string packageId, string version)> packages,
        CancellationToken ct = default);
}
